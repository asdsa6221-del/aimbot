-- Hype Lock-on inside RunService.Stepped
RunService.RenderStepped:Connect(function()
    local character = LocalPlayer.Character
    if character then
        -- NoClip
        if NOCLIP_ENABLED then
            local humanoid = character:FindFirstChildOfClass("Humanoid")
            if humanoid then
                for _, part in pairs(character:GetChildren()) do
                    if part:IsA("BasePart") then
                        part.CanCollide = false
                    end
                end
                humanoid:ChangeState(Enum.HumanoidStateType.Physics)
            end
        else
            for _, part in pairs(character:GetChildren()) do
                if part:IsA("BasePart") then
                    part.CanCollide = true
                end
            end
        end

        -- Hype Lock-on
        if HYPE_ENABLED then
            local closestPlayer = nil
            local shortestDistance = math.huge
            for _, plr in pairs(Players:GetPlayers()) do
                if plr ~= LocalPlayer and plr.Character and plr.Character:FindFirstChild("Head") then
                    local distance = (plr.Character.Head.Position - character.Head.Position).Magnitude
                    if distance < shortestDistance then
                        shortestDistance = distance
                        closestPlayer = plr
                    end
                end
            end
            if closestPlayer and closestPlayer.Character:FindFirstChild("Head") then
                -- Make camera scriptable if it isnâ€™t already
                Camera.CameraType = Enum.CameraType.Scriptable
                local targetPos = closestPlayer.Character.Head.Position
                local camPos = Camera.CFrame.Position
                -- Smoothly interpolate the camera
                Camera.CFrame = CFrame.new(camPos, targetPos)
            end
        else
            -- Reset camera to default if hype off
            if Camera.CameraType == Enum.CameraType.Scriptable then
                Camera.CameraType = Enum.CameraType.Custom
            end
        end
    end
end)
